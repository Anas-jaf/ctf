from sage.crypto.util import ascii_to_bin
from random import randint

FLAG = "flag{debug_flag}"
m = int(str(ascii_to_bin(FLAG)), 2)

p = random_prime((2^512)-1, False, 2^(512-1))
q = random_prime((2^512)-1, False, 2^(512-1))
n = p*q
e = 65537
a, b = randint(1, n-1), randint(1, n-1)

mat = Matrix(Zmod(n), [
	[a, b],
	[0, a]
])

c_mat = mat^p
c = pow(m, e, n)

print(f"{n = }")
print(f"{c_mat = }")
print(f"{c = }")

# output
"""
n = 75853283139231178090272201558259692424349496800980848191230600379115586050804144907938789844533033015595914946228295033669436997941574534033577730186677993735594220449624099065736920619061251640203753172577480562324202825348820754479597958245814025658285899164348958560278667842786136927839974156713056432111
c_mat = [73314510671581373309466811116116069271666948168375836105445873251745535294186820536889424173734638599641088849292516461533859130648056654308956994746357915008921644464357968066555806216441786736884138936737736120941800878810119147027353526244332676792491498084681067860656550508647882105672337546788738532636  1608772981034534900348130899877872413799797230466047803674466194785324024561736653069099667586746612212390930289051660488600246325974130320710217205958270066005395836938897141799613432275118178066342620337542887916173225969795417975537393782460619042287963079640560476980284328380551228593373999220283425862]
		[0 73314510671581373309466811116116069271666948168375836105445873251745535294186820536889424173734638599641088849292516461533859130648056654308956994746357915008921644464357968066555806216441786736884138936737736120941800878810119147027353526244332676792491498084681067860656550508647882105672337546788738532636]
c = 66926975694965429344312957825339837246852891610388915064189901287122478630679110716327645968503597690998923334973396061731721186758427289254477299960977404600781073854409174733761195218509163709749262669214738234499102331934319460635811752611083149428577004613427081649573137130724388917625681506011029322273
"""